0.8.3 luckydog7s port modified by Yello